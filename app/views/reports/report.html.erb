<head>
  <%= stylesheet_link_tag "application", :media => "all" %>

  <%= javascript_include_tag  "jquery.slim.min", "tether.min", "bootstrap.min" %>
</head>


<style>
h1 {
	text-decoration: underline;
	font-weight: bold;
}

th {
  text-align: center;
  background: green;
  color: white;
  border: 1px solid black;
  font-weight: bold;
}

span.red {
	color: red;
}

</style>


<%= link_to :controller => 'reports', :action => 'index' do %>
  <button type="button" class="btn btn-info">Generate New Report</button>
<% end %>

<h1>Royalty Report: <%= @titles.find(1).artist.e_name %></h1>
<h3><span class="red"><%= @start_date_str %> - <%= @end_date_str %></span></h3>


<table class="table table-responsive table-striped table-hover mx-auto">
    <tr>
      <th>Title</th>
      <th>Downloads</th>
      <th>SRP</th>
      <th>Gross Sales</th>
      <th>Dist. & Rate Fee</th>
      <th>Net Sales</th>
      <th>Rate</th>
      <th>Royalty Due</th>

    </tr>


    <% @titles.each do |title| %>
        <tr style="text-align:center">
          <td><%= title.e_title %></td> 
          <td><%= title.sales.where(:created_at => @start_date.beginning_of_day..@end_date.end_of_day).count %></td>
          <td>$<%= title.srp %></td>
          <td>$<%= title.sales.where(:created_at => @start_date.beginning_of_day..@end_date.end_of_day).count * title.srp %></td>
          <td>$<%= (title.sales.where(:created_at => @start_date.beginning_of_day..@end_date.end_of_day).count * title.srp) * 0.3 %></td>
          <td>$<%= ((title.sales.where(:created_at => @start_date.beginning_of_day..@end_date.end_of_day).count * title.srp) - (title.sales.where(:created_at => @start_date.beginning_of_day..@end_date.end_of_day).count * title.srp)) * 0.3 %></td>
          <td>20%</td>
          <td>$<%= ((title.sales.where(:created_at => @start_date.beginning_of_day..@end_date.end_of_day).count * title.srp)  - (title.sales.where(:created_at => @start_date.beginning_of_day..@end_date.end_of_day).count * title.srp) * 0.3) * 0.2 %></td>
        </tr>
   <% end %>
</table> 